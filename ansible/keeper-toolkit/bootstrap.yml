---
#
##
### @YesWeScale
##
#
- hosts: data_nodes
  become: yes

  roles:
    - common
    - glusterfs_node
#
##
### Client configuration
##
#
- hosts: local
  become: yes

  roles:
    - common
    - gluster_client_node

  tasks:
    - name: gluster volume mounted
      mount:
        name="/mnt/{{ item.name }}"
        src="{{ groups['data_nodes'][0] }}:{{ item.name }}"
        fstype=glusterfs
        opts="defaults,_netdev"
        state=mounted
      with_items: "{{ gluster_server_node.volumes }}"
      tags: client
